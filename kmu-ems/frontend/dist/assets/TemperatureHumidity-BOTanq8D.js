import{g as ce}from"./api-8psXf2YU.js";import{d as J,c,m as i,F as R,f as l,t as r,i as x,y as p,s as S,r as u,o as ue,z as de,A as he,B as fe,C as T,n as Y,x as ve,q as xe,p as I,j as $}from"./index-Ee9NYFW_.js";import{c as E}from"./createLucideIcon-gKcoRWno.js";const pe=E("droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);const ye=E("thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);const Z=E("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),me="/assets/ServerRoomBG-Dh5bvdzP.png",ge={class:"mx-2"},we={class:"w-full px-2 py-1 flex flex-row items-center bg-[#303030]/60"},be={class:"w-fit px-2 font-bold border-b-2 border-white"},_e={class:"py-1 flex flex-row items-center justify-center border-t-2 border-white"},ke={key:0,class:"flex flex-row gap-2 bg-[#303030]/60 border-4 border-[#0067AC] rounded-lg"},Ce={class:"flex-1 p-2 flex flex-col"},$e={class:"self-start flex flex-row items-center gap-1"},Se={class:"self-center my-2 text-3xl font-bold"},Ae={class:"self-end"},je={class:"flex-1 p-2 flex flex-col"},ze={class:"self-end flex flex-row-reverse items-center gap-1"},Le={class:"self-center my-2 text-3xl font-bold"},Me={class:"self-end"},Be={key:1,class:"flex flex-row gap-2 bg-[#303030]/60 border-4 border-[#0067AC] rounded-lg"},Te={class:"flex-1 p-2 flex flex-col"},Re={class:"self-start flex flex-row items-center gap-1"},Ee={class:"self-center my-2 text-3xl font-bold"},De={class:"self-end"},Ne={class:"flex-1 p-2 flex flex-col"},He={class:"self-end flex flex-row-reverse items-center gap-1"},Pe={class:"self-center my-2 text-3xl font-bold"},Ue={class:"self-end"},G=J({__name:"ValueCard",props:{title:{},value1:{},value2:{},ups:{type:Boolean}},setup(o){return(A,d)=>(i(),c(R,null,[l("div",ge,[l("div",we,[l("p",be,r(o.title),1),d[0]||(d[0]=l("div",{class:"w-[1rem] h-full"},[l("div",{class:"w-[2px] h-[2rem] bg-white origin-bottom-left rotate-[36deg] -translate-x-[2px] -translate-y-[4px]"})],-1)),l("div",_e,[(i(),x(p(o.value1.icon),{class:S(["w-4 h-4",o.ups?"fill-white":""])},null,8,["class"])),(i(),x(p(o.value2.icon),{class:S(["w-4 h-4",o.ups?"hidden":""])},null,8,["class"]))])])]),o.ups?(i(),c("div",ke,[l("div",Ce,[l("div",$e,[(i(),x(p(o.value1.icon),{class:"w-5 h-5 mb-1 fill-white"})),l("p",null,r(o.value1.title),1)]),l("p",Se,r(o.value1.value),1),l("p",Ae,r(o.value1.unit),1)]),d[1]||(d[1]=l("div",{class:"self-stretch w-[4px] bg-[#0067AC]"},null,-1)),l("div",je,[l("div",ze,[(i(),x(p(o.value2.icon),{class:"w-5 h-5 mb-1"})),l("p",null,r(o.value2.title),1)]),l("p",Le,r(o.value2.value),1),l("p",Me,r(o.value2.unit),1)])])):(i(),c("div",Be,[l("div",Te,[l("div",Re,[(i(),x(p(o.value1.icon),{class:"w-5 h-5 mb-1"})),l("p",null,r(o.value1.title),1)]),l("p",Ee,r(o.value1.value),1),l("p",De,r(o.value1.unit),1)]),d[2]||(d[2]=l("div",{class:"self-stretch w-[4px] bg-[#0067AC]"},null,-1)),l("div",Ne,[l("div",He,[(i(),x(p(o.value2.icon),{class:"w-5 h-5 mb-1"})),l("p",null,r(o.value2.title),1)]),l("p",Pe,r(o.value2.value),1),l("p",Ue,r(o.value2.unit),1)])]))],64))}}),Ve={class:"absolute w-full h-screen flex items-center justify-center z-[-1]"},We=["viewBox"],Xe=["x1","y1","x2","y2"],qe=["cx","cy"],Fe=["cx","cy"],Oe=["x1","y1","x2","y2"],Ye=["x","y","width","height"],Ie=["cx","cy","r"],Ze={key:0},Ge={class:"mx-2"},Ke={class:"w-full px-2 py-1 flex flex-row items-center bg-[#303030]/60"},Je={class:"w-fit px-2 font-bold border-b-2 border-white"},Qe={class:"w-fit px-2 font-bold border-t-2 border-white"},et={class:"p-2 grid grid-cols-2 bg-[#303030]/60 border-4 border-[#0067AC] rounded-lg *:text-center"},tt={key:1},lt={key:2},K=10,nt=J({__name:"TemperatureHumidity",setup(o){const A=u(null),d=u(null),Q=u({width:0,height:0}),a=u({left:0,top:0,width:0,height:0}),h=u(null),f=u(null),j=u(new Map),D=u([]),N=u(!1);function ee(e){return e?e instanceof HTMLElement?e:e.$el??null:null}function te(e,s){const n=ee(s),t=e;if(n){j.value.set(t,n);return}j.value.delete(t)}function H(e){return e&&typeof e=="object"&&"temp"in e&&"hum"in e?e:null}function P(e){return e&&typeof e=="object"&&"voltage"in e&&"current"in e?e:null}function U(e){return typeof e=="boolean"?e:null}function z(e,s,n){return Number.isNaN(e)?s:Math.min(Math.max(e,s),n)}const le={device1:{start:"left",end:"bottom",vertical:1},device2:{start:"right",end:"bottom",vertical:1},UPS:{start:"right",end:"bottom",vertical:1},doorSwitch:{start:"right",end:"left",vertical:1,horizontal:-1}};function se(e,s){return s.type==="circle"?{x:e.x,y:e.y+s.radius}:{x:e.x,y:e.y+s.height/2}}function oe(e,s,n){if(s.type==="circle"){const w=Math.max(s.radius-K,4),b=z(n-e.y,-w,w),_=Math.sqrt(Math.max(s.radius**2-b**2,0));return{x:e.x-_,y:e.y+b}}const t=s.height/2,v=Math.max(t-K/2,4),g=z(n-e.y,-v,v);return{x:e.x-s.width/2,y:e.y+g}}function y(){if(h.value){const e=h.value.getBoundingClientRect();Q.value={width:e.width,height:e.height}}V()}function V(){if(f.value&&h.value){const e=h.value.getBoundingClientRect(),s=f.value.getBoundingClientRect();a.value={left:s.left-e.left,top:s.top-e.top,width:s.width,height:s.height}}}function m(){if(!h.value||!f.value||a.value.width===0)return;const e=[];q.forEach(s=>{const n=j.value.get(s.key);if(!n)return;const t=le[s.key],v=s.cardLocation[0]/100*a.value.width,g=s.cardLocation[1]/100*a.value.height,w=n.offsetWidth/2,b=n.offsetHeight/2,_=v-w,F=g-b,O=2/3;let L=v,M=g;t.start==="left"?(L=_,M=F+n.offsetHeight*O):t.start==="right"&&(L=_+n.offsetWidth,M=F+n.offsetHeight*O);const k={x:L,y:M},B={x:s.point[0]/100*a.value.width,y:s.point[1]/100*a.value.height};let C;t.end==="bottom"?C=se(B,s.targetShape):C=oe(B,s.targetShape,k.y);const re={x:z((k.x+C.x)/2,0,a.value.width),y:k.y};e.push({id:s.id,start:k,joint:re,end:C,target:B,targetShape:s.targetShape})}),D.value=e,N.value=e.length>0}function ie(e,s){let n;return((...t)=>{clearTimeout(n),n=setTimeout(()=>e.apply(null,t),s)})}const W=ie(()=>{y(),V(),m()},100);function X(){W()}async function ae(){try{const e=await ce();A.value=e,d.value=new Date}catch(e){e instanceof Error?(console.log("資料獲取錯誤"),console.log(e.message)):console.error(e)}}ue(async()=>{await ae(),await de(),setTimeout(()=>{y(),m()},100),f.value&&(f.value.complete?(y(),m()):f.value.addEventListener("load",()=>{y(),m()},{once:!0})),window.addEventListener("resize",X);const e=new MutationObserver(()=>{W()});return h.value&&e.observe(h.value,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class"]}),()=>{window.removeEventListener("resize",X),e.disconnect()}});const q=[{id:1,key:"device1",name:"溫溼度計偵測器#1",point:[19.8,18.5],cardLocation:[38,25],dataType:"sensor",targetShape:{type:"circle",radius:30}},{id:2,key:"device2",name:"溫溼度計偵測器#2",point:[76.9,11.5],cardLocation:[62,21],dataType:"sensor",targetShape:{type:"circle",radius:30}},{id:3,key:"UPS",name:"UPS#1當前使用情況",point:[64,71],cardLocation:[50,85],dataType:"ups",targetShape:{type:"rect",width:80,height:80}},{id:4,key:"doorSwitch",name:["當前狀況","門禁狀況"],point:[29.5,58.5],cardLocation:[15,45],dataType:"door",targetShape:{type:"circle",radius:30}}],ne=he(()=>q.map(e=>({...e,section:A.value?.[e.key]})));return(e,s)=>{const n=ve("card");return i(),c("div",{class:"w-full h-full xl:min-h-screen relative overflow-hidden",ref_key:"containerRef",ref:h},[l("div",Ve,[l("img",{ref_key:"bgModelRef",ref:f,src:me,class:"max-w-full max-h-full object-contain"},null,512)]),N.value?(i(),c("svg",{key:0,class:"absolute z-15 pointer-events-none",style:T(`left: ${a.value.left}px; top: ${a.value.top}px; width: ${a.value.width}px; height: ${a.value.height}px;`),viewBox:`0 0 ${a.value.width} ${a.value.height}`},[(i(!0),c(R,null,Y(D.value,t=>(i(),c("g",{key:t.id},[l("line",{x1:t.start.x,y1:t.start.y,x2:t.joint.x,y2:t.joint.y,stroke:"#0067AC","stroke-width":"4",opacity:"0.8"},null,8,Xe),l("circle",{cx:t.joint.x,cy:t.joint.y,r:"6",fill:"transparent",stroke:"#0067AC","stroke-width":"2"},null,8,qe),l("circle",{cx:t.joint.x,cy:t.joint.y,r:"4",fill:"#0067AC"},null,8,Fe),l("line",{x1:t.joint.x,y1:t.joint.y,x2:t.end.x,y2:t.end.y,stroke:"#0067AC","stroke-width":"4",opacity:"0.8"},null,8,Oe),t.targetShape.type==="rect"?(i(),c("rect",{key:0,x:t.target.x-t.targetShape.width/2,y:t.target.y-t.targetShape.height/2,width:t.targetShape.width,height:t.targetShape.height,fill:"#0067AC4D",stroke:"#0067AC","stroke-width":"4"},null,8,Ye)):(i(),c("circle",{key:1,cx:t.target.x,cy:t.target.y,r:t.targetShape.radius,fill:"#0067AC4D",stroke:"#0067AC","stroke-width":"4"},null,8,Ie))]))),128))],12,We)):fe("",!0),l("div",{class:"absolute z-30",style:T(`left: ${a.value.left}px; top: ${a.value.top}px; width: ${a.value.width}px; height: ${a.value.height}px;`)},[(i(!0),c(R,null,Y(ne.value,t=>(i(),x(n,{key:t.id,ref_for:!0,ref:v=>te(t.key,v),class:"absolute w-[18rem] max-w-[20%] cursor-pointer group",style:T({top:`${t.cardLocation[1]/100*a.value.height}px`,left:`${t.cardLocation[0]/100*a.value.width}px`,transform:"translate(-50%, -50%)"})},{default:xe(()=>[t.dataType==="door"?(i(),c("div",Ze,[l("div",Ge,[l("div",Ke,[l("p",Je,r(t.name[0]),1),s[0]||(s[0]=l("div",{class:"w-[1rem] h-full"},[l("div",{class:"w-[2px] h-[2rem] bg-white origin-bottom-left rotate-[36deg] -translate-x-[2px] -translate-y-[4px]"})],-1)),l("p",Qe,r(t.name[1]),1)])]),l("div",et,[l("div",{class:S(["m-2 border rounded-full",U(t.section)?"bg-[#67cc69]":"inset-shadow-md"])},"房門開啟",2),l("div",{class:S(["m-2 border rounded-full",U(t.section)?"inset-shadow-md":"bg-[#67cc69]"])},"房門關閉",2)])])):t.dataType==="ups"?(i(),c("div",tt,[I(G,{title:t.name,value1:{icon:$(Z),title:"電壓",value:P(t.section)?.voltage??null,unit:"V"},value2:{icon:$(Z),title:"電流",value:P(t.section)?.current??null,unit:"A"},ups:!0},null,8,["title","value1","value2"])])):(i(),c("div",lt,[I(G,{title:t.name,value1:{icon:$(ye),title:"溫度",value:H(t.section)?.temp??null,unit:"°C"},value2:{icon:$(pe),title:"濕度",value:H(t.section)?.hum??null,unit:"%"},ups:!1},null,8,["title","value1","value2"])]))]),_:2},1032,["style"]))),128))],4)],512)}}});export{nt as default};
